
# Input the data
F1_1 <- c(0.0964, 0.0631, 0.0318, 0.0594, 0.0161, 0.0365, 0.0695, 0.0690, 0.0247, 0.0412, 0.1003, 0.0524, 0.0193, 0.0343, 0.0480, 0.0797, 0.0467, 0.0121, 0.0253, 0.0741)

F10_1 <- c(0.0951815,0.0898734,0.0400739,0.0566552,0.0258627,0.0411491,0.036316,0.0295645,0.0290678,0.0244669,0.103115,0.0879412,0.0510774,0.00973801,0.00399189,0.106363,0.094909,0.00392678,0.00909412,0.0616326)
F10_2 <- c(0.0791651,0.0633787,0.0307722,0.0000875455,0.0249962,0.0248807,0.0281768,0.0856778,0.0346434,0.0447194,0.156142,0.00275651,0.0653901,0.0871013,0.0752194,0.0587292,0.014828,0.0225379,0.0364103,0.0643878)
F10_3 <- c(0.159865,0.0947391,0.0507743,0.0344274,0.0000920482,0.0141003,0.0567542,0.0809695,0.0293498,0.0195388,0.100466,0.0527175,0.00881687,0.0000920482,0.0564458,0.098429,0.0371892,0.0212744,0.0162594,0.0676994)
F10_4 <- c(0.122953,0.0696851,0.00342007,0.0580904,0.0449335,0.0220916,0.0288058,0.0568581,0.0566351,0.0221778,0.0608678,0.0501054,0.00571208,0.0674747,0.0113555,0.14012,0.0391373,0.00707712,0.0639785,0.0685206)
F10_5 <- c(0.0691583,0.021993,0.0269766,0.0127757,0.0509711,0.00632125,0.00521974,0.0145802,0.00394856,0.167407,0.246906,0.000308235,0.0250452,0.0419772,0.0104131,0.00718915,0.0290562,0.0115716,0.021482,0.2267)
F10_6 <- c(0.131608,0.0996116,0.0161474,0.0455742,0.0064738,0.0880735,0.0813327,0.0648054,0.0188262,0.0296626,0.130996,0.0737761,0.0119013,0.0405873,0.000091681,0.0771084,0.0158113,0.000091681,0.000091681,0.0674293)
F10_7 <- c(0.0378795,0.0678643,0.0435899,0.112753,0.000130103,0.0217906,0.0843666,0.12107,0.00807882,0.0607061,0.0224495,0.067956,0.0199518,0.0218261,0.061458,0.0841364,0.0134502,0.00794212,0.0469138,0.0956877)
F10_8 <- c(0.0899257,0.0361378,0.0107289,0.0990157,0.00101999,0.0404787,0.135411,0.0476142,0.0109771,0.0290578,0.0611128,0.0409312,0.0168603,0.0224945,0.0770708,0.0587654,0.0982625,0.0155625,0.05368,0.0548929)
F10_9 <- c(0.147919,0.045668,0.0354327,0.0892718,0.00187309,0.0421802,0.140897,0.0473804,0.021272,0.016008,0.027086,0.0873209,0.0126555,0.0515414,0.0703138,0.0492243,0.0320147,0.0228702,0.0000802069,0.0589904)
F10_10 <- c(0.0342052,0.0404088,0.0418635,0.044969,0.0243696,0.0529587,0.069029,0.129522,0.0261134,0.0232404,0.100453,0.0458736,0.0000813327,0.0000813327,0.105747,0.102512,0.0647891,0.0218914,0.0120732,0.0598184)

C10_1 <- c(0.4082573125, 0.0081783015, 0.0096285438, 0.0069870889, 0.0349388179, 0.0075279735, 0.0097846653, 0.1221613215, 0.0039151830, 0.0125784287, 0.0158338663, 0.0059670150, 0.0081313216, 0.0061604332, 0.0394155867, 0.1682450664, 0.0658132542, 0.0018751587, 0.0041579747, 0.0604426865)
C10_2 <- c(0.1027763487, 0.0418664491, 0.0213272051, 0.0155943616, 0.0149663448, 0.0440685478, 0.0419667447, 0.0138805792, 0.0158864807, 0.1066076641, 0.1131944125, 0.0436343681, 0.0437800327, 0.0180729309, 0.0223250701, 0.0529608087, 0.1081741005, 0.0045147205, 0.0137373857, 0.1606654446)
C10_3 <- c(0.0351766018, 0.0019678632, 0.0016591476, 0.0006768741, 0.0078706538, 0.0016559557, 0.0019686768, 0.0022420602, 0.0012878339, 0.3515819591, 0.1278183107, 0.0018856550, 0.0242631753, 0.0126221329, 0.0029771559, 0.0049998099, 0.0255378034, 0.0011907778, 0.0037539283, 0.3888636245)
C10_4 <- c(0.0408513927, 0.0269887074, 0.2185648186, 0.2333814790, 0.0037602852, 0.0380451418, 0.0901238869, 0.1158332065, 0.0373197176, 0.0025523644, 0.0052164616, 0.0485017266, 0.0022571778, 0.0025108218, 0.0108333610, 0.0804527209, 0.0302879995, 0.0010815260, 0.0069890931, 0.0044481118)
C10_5 <- c(0.0185492661, 0.0062362395, 0.0024895723, 0.0009775062, 0.0070416514, 0.0083539447, 0.0024891617, 0.0028952913, 0.0040103982, 0.1632422345, 0.4443079409, 0.0043570878, 0.1202815687, 0.0733329781, 0.0048827648, 0.0051642443, 0.0131806647, 0.0068759784, 0.0144734420, 0.0968580644)
C10_6 <- c(0.1106750119, 0.0352190043, 0.0405186210, 0.1636437899, 0.0014834855, 0.0877962201, 0.2638456592, 0.0325228293, 0.0163803600, 0.0068334902, 0.0140679579, 0.0677158208, 0.0048988133, 0.0023256777, 0.0298982139, 0.0562887953, 0.0426922497, 0.0010338979, 0.0040522304, 0.0181078719)
C10_7 <- c(0.0522657662, 0.0668294648, 0.0714836849, 0.0297745257, 0.0143324928, 0.0736540298, 0.0388386669, 0.0228101108, 0.1551638111, 0.0187406149, 0.0653779932, 0.0439469345, 0.0207189121, 0.0624033021, 0.0145475497, 0.0549017631, 0.0370140058, 0.0193756900, 0.1110694548, 0.0267512268)
C10_8 <- c(0.0116587342, 0.0050990142, 0.0064011054, 0.0021742457, 0.0105340743, 0.0040203734, 0.0024251112, 0.0034709143, 0.0366787049, 0.0187185330, 0.0676489746, 0.0026694717, 0.0143534813, 0.3650985596, 0.0031159927, 0.0094848536, 0.0073713920, 0.0509564551, 0.3574858593, 0.0206341497)
C10_9 <- c(0.0627195947, 0.2038782162, 0.0428629162, 0.0236193294, 0.0052662886, 0.1098111767, 0.0686284994, 0.0256174957, 0.0332612124, 0.0128968249, 0.0305627740, 0.2270839355, 0.0124036991, 0.0039181841, 0.0140440613, 0.0483152469, 0.0463378087, 0.0025143473, 0.0065521118, 0.0197062770)
C10_10 <- c(0.1145518598, 0.0324008908, 0.0750614981, 0.0416192189, 0.0098549497, 0.0339624663, 0.0364907910, 0.0503817581, 0.0165233329, 0.0092949460, 0.0139153707, 0.0423026886, 0.0082240805, 0.0046605982, 0.0379221548, 0.2610647896, 0.1845829279, 0.0017548981, 0.0058538316, 0.0195769483)

Dayhoff <- c(0.08712691, 0.04090396, 0.04043196, 0.04687195, 0.03347397, 0.03825496, 0.04952995, 0.08861191, 0.03361897, 0.03688596, 0.08535691, 0.08048092, 0.01475299, 0.03977196, 0.05067995, 0.06957693, 0.05854194, 0.01049399, 0.02991597, 0.06471794)
LG <- c(0.07906592, 0.05594094, 0.04197696, 0.05305195, 0.01293699, 0.04076696, 0.07158593, 0.05733694, 0.02235498, 0.06215694, 0.0990809, 0.06459994, 0.02295098, 0.04230196, 0.04403996, 0.06119694, 0.05328695, 0.01206599, 0.03415497, 0.06914693)
JTT <- c(0.07674792, 0.05169095, 0.04264496, 0.05154395, 0.01980298, 0.04075196, 0.06182994, 0.07315193, 0.02294398, 0.05376095, 0.09190391, 0.05867594, 0.02382598, 0.04012596, 0.05090095, 0.06876493, 0.05856494, 0.01426099, 0.03210197, 0.06600493)
WAG <- c(0.08662791, 0.043972, 0.0390894, 0.05704511, 0.0193078, 0.0367281, 0.05805891, 0.08325181, 0.0244313, 0.048466, 0.08620901, 0.06202861, 0.0195027, 0.0384319, 0.0457631, 0.06951791, 0.06101271, 0.0143859, 0.0352742, 0.07089561)
VT <- c(0.0770764620135024, 0.0500819370772208, 0.0462377395993731, 0.0537929860758246, 0.0144533387583345, 0.0408923608974345, 0.0633579339160905, 0.0655672355884439, 0.0218802687005936, 0.0591969699027449, 0.0976461276528445, 0.0592079410822730, 0.0220695876653368, 0.0413508521834260, 0.0476871596856874, 0.0707295165111524, 0.0567759161524817, 0.0127019797647213, 0.0323746050281867, 0.0669190817443274)
Blosum62 <- c(0.074, 0.052, 0.045, 0.054, 0.025, 0.034, 0.054, 0.074, 0.026, 0.068, 0.099, 0.058, 0.025, 0.047, 0.039, 0.057, 0.051, 0.013, 0.032, 0.073)
PMB <- c(0.07559244, 0.05379462, 0.03769623, 0.04469553, 0.02849715, 0.03389661, 0.05349465, 0.0779922, 0.029997, 0.05989401, 0.09579042, 0.0519948, 0.02189781, 0.0449955, 0.0419958, 0.06819318, 0.05639436, 0.01569843, 0.0359964, 0.07149285)
Q_plant <- c(0.074923000, 0.050500000, 0.038734000, 0.053195000, 0.011300000, 0.037499000, 0.068513000, 0.059627000, 0.021204000, 0.058991000, 0.102504000, 0.067306000, 0.022371000, 0.043798000, 0.037039000, 0.084451000, 0.047850000, 0.012322000, 0.030777000, 0.077097000)
mtREV <- c(0.072, 0.019, 0.039, 0.019, 0.006, 0.025, 0.024, 0.056, 0.028, 0.088, 0.169, 0.023, 0.054, 0.061, 0.054, 0.072, 0.086, 0.029, 0.033, 0.043)
mtMet <- c(0.043793213137964, 0.012957803887341, 0.057001317100395, 0.016899005069702, 0.011330503399151, 0.018018105405432, 0.022538506761552, 0.047050114115034, 0.017183705155112, 0.089779426933828, 0.155226046567814, 0.039913511974054, 0.067444320233296, 0.088448026534408, 0.037528211258463, 0.093752228125668, 0.063579019073706, 0.022671306801392, 0.041568212470464, 0.053317415995225)
mtVer <- c(0.070820264589868, 0.014049892975054, 0.045209877395061, 0.014793692603154, 0.006814196592902, 0.026340886829557, 0.021495189252405, 0.044239977880011, 0.024230987884506, 0.090735054632473, 0.172309913845043, 0.027381186309407, 0.056193971903014, 0.049775775112112, 0.054386272806864, 0.074421862789069, 0.108809945595027, 0.025652687173656, 0.026484686757657, 0.045853677073162)
mtInv <- c(0.031742312696925, 0.010900704360282, 0.061579224631690, 0.016149206459683, 0.013570105428042, 0.014644105857642, 0.022311208924484, 0.047847519139008, 0.011641804656722, 0.094322337728935, 0.149407059762824, 0.044438717775487, 0.077262530905012, 0.102287040914816, 0.026290210516084, 0.105939042375617, 0.042869117147647, 0.020701008280403, 0.046556718622687, 0.059540023816010)
mtMAM <- c(0.0692, 0.0184, 0.0400, 0.0186, 0.0065, 0.0238, 0.0236, 0.0557, 0.0277, 0.0905, 0.1675, 0.0221, 0.0561, 0.0611, 0.0536, 0.0725, 0.0870, 0.0293, 0.0340, 0.0428)
mtART <- c(0.054116, 0.018227, 0.039903, 0.020160, 0.009709, 0.018781, 0.024289, 0.068183, 0.024518, 0.092638, 0.148658, 0.021718, 0.061453, 0.088668, 0.041826, 0.091030, 0.049194, 0.029786, 0.039443, 0.057700)
mtZOA <- c(0.06887993, 0.02103698, 0.03038997, 0.02069598, 0.00996599, 0.01862298, 0.02498898, 0.07196793, 0.02681397, 0.08507191, 0.15671684, 0.01927598, 0.05065195, 0.08171192, 0.04480296, 0.08053492, 0.05638594, 0.02799797, 0.03740396, 0.06608293)
rtREV <- c(0.0646, 0.0453, 0.0376, 0.0422, 0.0114, 0.0606, 0.0607, 0.0639, 0.0273, 0.0679, 0.1018, 0.0751, 0.0150, 0.0287, 0.0681, 0.0488, 0.0622, 0.0251, 0.0318, 0.0619)
cpREV <- c(0.0755, 0.0621, 0.0410, 0.0371, 0.0091, 0.0382, 0.0495, 0.0838, 0.0246, 0.0806, 0.1011, 0.0504, 0.0220, 0.0506, 0.0431, 0.0622, 0.0543, 0.0181, 0.0307, 0.0660)
HIVb <- c(0.060490222, 0.066039665, 0.044127815, 0.042109048, 0.020075899, 0.053606488, 0.071567447, 0.072308239, 0.022293943, 0.069730629, 0.098851122, 0.056968211, 0.019768318, 0.028809447, 0.046025282, 0.050604330, 0.053636813, 0.033011601, 0.028350243, 0.061625237)
HIVw <- c(0.0377494, 0.0573210, 0.0891129, 0.0342034, 0.0240105, 0.0437824, 0.0618606, 0.0838496, 0.0156076, 0.0983641, 0.0577867, 0.0641682, 0.0158419, 0.0422741, 0.0458601, 0.0550846, 0.0813774, 0.0195970, 0.0205847, 0.0515638)
FLU <- c(0.04707195, 0.05090995, 0.07421393, 0.04785995, 0.02502197, 0.03330397, 0.05458695, 0.07637292, 0.01996398, 0.06713393, 0.07149793, 0.05678494, 0.01815098, 0.03049597, 0.05065595, 0.08840891, 0.07433893, 0.01852398, 0.03147397, 0.06322894)

# Add row names and column names to the matrix
profile_matrix <- rbind(F1_1,
                        F10_1, F10_2, F10_3, F10_4, F10_5, F10_6, F10_7, F10_8, F10_9, F10_10,
                        #C10_1, C10_2, C10_3, C10_4, C10_5, C10_6, C10_7, C10_8, C10_9, C10_10,
                        Dayhoff, LG, JTT, WAG, VT, Blosum62, PMB, Q_plant,
                        mtREV, mtMet, mtVer, mtInv, mtMAM, mtART, mtZOA, rtREV, cpREV, HIVb, HIVw, FLU)
rownames(profile_matrix) <- c("F1.1 (1.0000)",
                              "F10.1 (0.0999)", "F10.2 (0.0984)", "F10.3 (0.1004)", "F10.4 (0.0990)", "F10.5 (0.0988)", "F10.6 (0.1010)", "F10.7 (0.0992)", "F10.8 (0.1017)", "F10.9 (0.1014)", "F10.10 (0.1001)",
                              #"C10.1 (0.1191)", "C10.2 (0.0874)", "C10.3 (0.1037)", "C10.4 (0.0923)", "C10.5 (0.1070)","C10.6 (0.1330)", "C10.7 (0.0538)", "C10.8 (0.0692)", "C10.9 (0.1320)", "C10.10 (0.1024)",
                              "Dayhoff (1.0000)", "LG (1.0000)", "JTT (1.0000)", "WAG (1.0000)", "VT (1.0000)", "Blosum62 (1.0000)", "PMB (1.0000)", "Q.plant (1.0000)",
                              "mtREV (1.0000)", "mtMet (1.0000)", "mtVer (1.0000)", "mtInv (1.0000)", "mtMAM (1.0000)", "mtART (1.0000)", "mtZOA (1.0000)", "rtREV (1.0000)", "cpREV (1.0000)", "HIVb (1.0000)", "HIVw (1.0000)", "FLU (1.0000)")
amino_acids <- c("A", "R", "N", "D", "C", "Q", "E", "G", "H", "I", "L", "K", "M", "F", "P", "S", "T", "W", "Y", "V")
colnames(profile_matrix) <- amino_acids

library(ggplot2)
library(ggrepel)

# Extract weights and scale them down to 50%
weights <- as.numeric(sub(".*\\((.*)\\)", "\\1", rownames(profile_matrix)))

# Extract labels, removing the brackets and the weights inside them
labels <- sub(" \\(.*\\)", "", rownames(profile_matrix))

# Create groups
groups <- sub("\\..*", "", labels)
general_indices <- which(labels %in% c("Dayhoff", "LG", "JTT", "WAG", "VT", "Blosum62", "PMB"))
groups[general_indices] <- "general"
mitochondrial_indices <- which(labels %in% c("mtREV", "mtMet", "mtVer", "mtInv", "mtMAM", "mtART", "mtZOA"))
groups[mitochondrial_indices] <- "mitochondrial"
viral_indices <- which(labels %in% c("rtREV", "cpREV", "HIVb", "HIVw", "FLU"))
groups[viral_indices] <- "viral"


# Perform PCA analysis
pca_result <- prcomp(profile_matrix, scale. = TRUE)

# Calculate the percentage of variance explained by each principal component
explained_variance <- pca_result$sdev^2 / sum(pca_result$sdev^2)
percent_variance <- explained_variance * 100

# Prepare the data frame for plotting
pca_data <- data.frame(pca_result$x, Weight = weights, Label = labels, Group = groups)

# Plot the PCA
ggplot(pca_data, aes(x = PC1, y = PC2, label = Label, color = Group)) +
  geom_point(aes(size = Weight), alpha = 0.7) +
  geom_text_repel() +
  scale_size_continuous(range = c(1, 5)) +
  theme_minimal() +
  labs(title = "PCA Plot of Frequency Vectors",
       x = paste0("PC1 (", round(percent_variance[1], 2), "%)"),
       y = paste0("PC2 (", round(percent_variance[2], 2), "%)"),
       size = "Weight",
       color = "Group") +
  theme(
    plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
    legend.title = element_text(size = 10),
    legend.text = element_text(size = 9),
    legend.key.size = unit(0.8, "lines"),
    legend.key.height = unit(0.6, "lines"),
    legend.key.width = unit(0.6, "lines"),
    legend.box.background = element_rect(color = "black", size = 0.5),
    legend.box.margin = margin(2, 2, 2, 2),
    legend.justification = "center",
    legend.box.just = "center",
    legend.title.align = 0.5
  )
