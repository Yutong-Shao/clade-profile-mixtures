
# Input the data
F1_1 <- c(0.0964, 0.0631, 0.0318, 0.0594, 0.0161, 0.0365, 0.0695, 0.0690, 0.0247, 0.0412, 0.1003, 0.0524, 0.0193, 0.0343, 0.0480, 0.0797, 0.0467, 0.0121, 0.0253, 0.0741)

F10_1 <- c(0.137315,0.00738656,0.0190614,0.119929,0.0062035,0.0084691,0.0773137,0.0406599,0.0000944466,0.0443403,0.0861331,0.0229603,0.0315825,0.0782116,0.0000944466,0.104113,0.0632577,0.00211458,0.0834287,0.0673314)
F10_2 <- c(0.138487,0.0756157,0.0187661,0.0482333,0.0117611,0.0532719,0.0923879,0.0106709,0.031281,0.00282101,0.160525,0.000084446,0.00389722,0.0562589,0.025539,0.149693,0.0209131,0.0167611,0.0228302,0.0602019)
F10_3 <- c(0.144351,0.0464158,0.0676745,0.0000766597,0.0278532,0.0613893,0.0731007,0.0870778,0.0440432,0.0335183,0.0975968,0.0561397,0.054696,0.0101713,0.00986901,0.0696948,0.00976753,0.00682873,0.0450845,0.054651)
F10_4 <- c(0.0158089,0.102047,0.0198877,0.0767252,0.0299931,0.0242505,0.0383824,0.0483266,0.087322,0.0381301,0.0706277,0.0562319,0.0100652,0.0671671,0.0145746,0.131483,0.0560061,0.0150364,0.0449492,0.0529853)
F10_5 <- c(0.069482,0.0371957,0.104882,0.106297,0.0278383,0.0596245,0.0329037,0.129742,0.0232504,0.0222079,0.0307485,0.0898494,0.00413362,0.0000803692,0.00291945,0.134481,0.0669069,0.0000803692,0.0000803692,0.0572955)
F10_6 <- c(0.0430328,0.00426393,0.00850958,0.0246198,0.0295675,0.0139483,0.00480741,0.0407608,0.000341615,0.213481,0.274634,0.00189381,0.0241902,0.0102992,0.0154965,0.000341615,0.0197455,0.02268,0.00384726,0.243539)
F10_7 <- c(0.0803545,0.035513,0.0283232,0.0553619,0.0238173,0.0471799,0.0386205,0.108269,0.0352631,0.0327936,0.0488747,0.0313668,0.00756975,0.0294382,0.179985,0.0938184,0.0453884,0.0164961,0.0149781,0.0465888)
F10_8 <- c(0.0914045,0.0182463,0.0288811,0.0581682,0.0000905515,0.0275747,0.103927,0.0535992,0.0156514,0.0212376,0.172261,0.0452874,0.0215043,0.032983,0.129437,0.0479151,0.0647593,0.0000905515,0.00242763,0.0645545)
F10_9 <- c(0.0985208,0.0479061,0.0280357,0.0588297,0.00715918,0.0127502,0.1132,0.127884,0.00052279,0.0165952,0.03161,0.102818,0.0241771,0.0363896,0.0754124,0.119718,0.027435,0.0100651,0.0000854054,0.0608858)
F10_10 <- c(0.119737,0.130919,0.00229038,0.000101425,0.0124037,0.0514481,0.0370904,0.0731602,0.0152908,0.0691943,0.0974134,0.106773,0.0302084,0.0498596,0.00727608,0.0413231,0.0730026,0.0100995,0.000101425,0.0723066)

C10_1 <- c(0.4082573125, 0.0081783015, 0.0096285438, 0.0069870889, 0.0349388179, 0.0075279735, 0.0097846653, 0.1221613215, 0.0039151830, 0.0125784287, 0.0158338663, 0.0059670150, 0.0081313216, 0.0061604332, 0.0394155867, 0.1682450664, 0.0658132542, 0.0018751587, 0.0041579747, 0.0604426865)
C10_2 <- c(0.1027763487, 0.0418664491, 0.0213272051, 0.0155943616, 0.0149663448, 0.0440685478, 0.0419667447, 0.0138805792, 0.0158864807, 0.1066076641, 0.1131944125, 0.0436343681, 0.0437800327, 0.0180729309, 0.0223250701, 0.0529608087, 0.1081741005, 0.0045147205, 0.0137373857, 0.1606654446)
C10_3 <- c(0.0351766018, 0.0019678632, 0.0016591476, 0.0006768741, 0.0078706538, 0.0016559557, 0.0019686768, 0.0022420602, 0.0012878339, 0.3515819591, 0.1278183107, 0.0018856550, 0.0242631753, 0.0126221329, 0.0029771559, 0.0049998099, 0.0255378034, 0.0011907778, 0.0037539283, 0.3888636245)
C10_4 <- c(0.0408513927, 0.0269887074, 0.2185648186, 0.2333814790, 0.0037602852, 0.0380451418, 0.0901238869, 0.1158332065, 0.0373197176, 0.0025523644, 0.0052164616, 0.0485017266, 0.0022571778, 0.0025108218, 0.0108333610, 0.0804527209, 0.0302879995, 0.0010815260, 0.0069890931, 0.0044481118)
C10_5 <- c(0.0185492661, 0.0062362395, 0.0024895723, 0.0009775062, 0.0070416514, 0.0083539447, 0.0024891617, 0.0028952913, 0.0040103982, 0.1632422345, 0.4443079409, 0.0043570878, 0.1202815687, 0.0733329781, 0.0048827648, 0.0051642443, 0.0131806647, 0.0068759784, 0.0144734420, 0.0968580644)
C10_6 <- c(0.1106750119, 0.0352190043, 0.0405186210, 0.1636437899, 0.0014834855, 0.0877962201, 0.2638456592, 0.0325228293, 0.0163803600, 0.0068334902, 0.0140679579, 0.0677158208, 0.0048988133, 0.0023256777, 0.0298982139, 0.0562887953, 0.0426922497, 0.0010338979, 0.0040522304, 0.0181078719)
C10_7 <- c(0.0522657662, 0.0668294648, 0.0714836849, 0.0297745257, 0.0143324928, 0.0736540298, 0.0388386669, 0.0228101108, 0.1551638111, 0.0187406149, 0.0653779932, 0.0439469345, 0.0207189121, 0.0624033021, 0.0145475497, 0.0549017631, 0.0370140058, 0.0193756900, 0.1110694548, 0.0267512268)
C10_8 <- c(0.0116587342, 0.0050990142, 0.0064011054, 0.0021742457, 0.0105340743, 0.0040203734, 0.0024251112, 0.0034709143, 0.0366787049, 0.0187185330, 0.0676489746, 0.0026694717, 0.0143534813, 0.3650985596, 0.0031159927, 0.0094848536, 0.0073713920, 0.0509564551, 0.3574858593, 0.0206341497)
C10_9 <- c(0.0627195947, 0.2038782162, 0.0428629162, 0.0236193294, 0.0052662886, 0.1098111767, 0.0686284994, 0.0256174957, 0.0332612124, 0.0128968249, 0.0305627740, 0.2270839355, 0.0124036991, 0.0039181841, 0.0140440613, 0.0483152469, 0.0463378087, 0.0025143473, 0.0065521118, 0.0197062770)
C10_10 <- c(0.1145518598, 0.0324008908, 0.0750614981, 0.0416192189, 0.0098549497, 0.0339624663, 0.0364907910, 0.0503817581, 0.0165233329, 0.0092949460, 0.0139153707, 0.0423026886, 0.0082240805, 0.0046605982, 0.0379221548, 0.2610647896, 0.1845829279, 0.0017548981, 0.0058538316, 0.0195769483)

Dayhoff <- c(0.08712691, 0.04090396, 0.04043196, 0.04687195, 0.03347397, 0.03825496, 0.04952995, 0.08861191, 0.03361897, 0.03688596, 0.08535691, 0.08048092, 0.01475299, 0.03977196, 0.05067995, 0.06957693, 0.05854194, 0.01049399, 0.02991597, 0.06471794)
LG <- c(0.07906592, 0.05594094, 0.04197696, 0.05305195, 0.01293699, 0.04076696, 0.07158593, 0.05733694, 0.02235498, 0.06215694, 0.0990809, 0.06459994, 0.02295098, 0.04230196, 0.04403996, 0.06119694, 0.05328695, 0.01206599, 0.03415497, 0.06914693)
JTT <- c(0.07674792, 0.05169095, 0.04264496, 0.05154395, 0.01980298, 0.04075196, 0.06182994, 0.07315193, 0.02294398, 0.05376095, 0.09190391, 0.05867594, 0.02382598, 0.04012596, 0.05090095, 0.06876493, 0.05856494, 0.01426099, 0.03210197, 0.06600493)
WAG <- c(0.08662791, 0.043972, 0.0390894, 0.05704511, 0.0193078, 0.0367281, 0.05805891, 0.08325181, 0.0244313, 0.048466, 0.08620901, 0.06202861, 0.0195027, 0.0384319, 0.0457631, 0.06951791, 0.06101271, 0.0143859, 0.0352742, 0.07089561)
VT <- c(0.0770764620135024, 0.0500819370772208, 0.0462377395993731, 0.0537929860758246, 0.0144533387583345, 0.0408923608974345, 0.0633579339160905, 0.0655672355884439, 0.0218802687005936, 0.0591969699027449, 0.0976461276528445, 0.0592079410822730, 0.0220695876653368, 0.0413508521834260, 0.0476871596856874, 0.0707295165111524, 0.0567759161524817, 0.0127019797647213, 0.0323746050281867, 0.0669190817443274)
Blosum62 <- c(0.074, 0.052, 0.045, 0.054, 0.025, 0.034, 0.054, 0.074, 0.026, 0.068, 0.099, 0.058, 0.025, 0.047, 0.039, 0.057, 0.051, 0.013, 0.032, 0.073)
PMB <- c(0.07559244, 0.05379462, 0.03769623, 0.04469553, 0.02849715, 0.03389661, 0.05349465, 0.0779922, 0.029997, 0.05989401, 0.09579042, 0.0519948, 0.02189781, 0.0449955, 0.0419958, 0.06819318, 0.05639436, 0.01569843, 0.0359964, 0.07149285)
Q_plant <- c(0.074923000, 0.050500000, 0.038734000, 0.053195000, 0.011300000, 0.037499000, 0.068513000, 0.059627000, 0.021204000, 0.058991000, 0.102504000, 0.067306000, 0.022371000, 0.043798000, 0.037039000, 0.084451000, 0.047850000, 0.012322000, 0.030777000, 0.077097000)
mtREV <- c(0.072, 0.019, 0.039, 0.019, 0.006, 0.025, 0.024, 0.056, 0.028, 0.088, 0.169, 0.023, 0.054, 0.061, 0.054, 0.072, 0.086, 0.029, 0.033, 0.043)
mtMet <- c(0.043793213137964, 0.012957803887341, 0.057001317100395, 0.016899005069702, 0.011330503399151, 0.018018105405432, 0.022538506761552, 0.047050114115034, 0.017183705155112, 0.089779426933828, 0.155226046567814, 0.039913511974054, 0.067444320233296, 0.088448026534408, 0.037528211258463, 0.093752228125668, 0.063579019073706, 0.022671306801392, 0.041568212470464, 0.053317415995225)
mtVer <- c(0.070820264589868, 0.014049892975054, 0.045209877395061, 0.014793692603154, 0.006814196592902, 0.026340886829557, 0.021495189252405, 0.044239977880011, 0.024230987884506, 0.090735054632473, 0.172309913845043, 0.027381186309407, 0.056193971903014, 0.049775775112112, 0.054386272806864, 0.074421862789069, 0.108809945595027, 0.025652687173656, 0.026484686757657, 0.045853677073162)
mtInv <- c(0.031742312696925, 0.010900704360282, 0.061579224631690, 0.016149206459683, 0.013570105428042, 0.014644105857642, 0.022311208924484, 0.047847519139008, 0.011641804656722, 0.094322337728935, 0.149407059762824, 0.044438717775487, 0.077262530905012, 0.102287040914816, 0.026290210516084, 0.105939042375617, 0.042869117147647, 0.020701008280403, 0.046556718622687, 0.059540023816010)
mtMAM <- c(0.0692, 0.0184, 0.0400, 0.0186, 0.0065, 0.0238, 0.0236, 0.0557, 0.0277, 0.0905, 0.1675, 0.0221, 0.0561, 0.0611, 0.0536, 0.0725, 0.0870, 0.0293, 0.0340, 0.0428)
mtART <- c(0.054116, 0.018227, 0.039903, 0.020160, 0.009709, 0.018781, 0.024289, 0.068183, 0.024518, 0.092638, 0.148658, 0.021718, 0.061453, 0.088668, 0.041826, 0.091030, 0.049194, 0.029786, 0.039443, 0.057700)
mtZOA <- c(0.06887993, 0.02103698, 0.03038997, 0.02069598, 0.00996599, 0.01862298, 0.02498898, 0.07196793, 0.02681397, 0.08507191, 0.15671684, 0.01927598, 0.05065195, 0.08171192, 0.04480296, 0.08053492, 0.05638594, 0.02799797, 0.03740396, 0.06608293)
rtREV <- c(0.0646, 0.0453, 0.0376, 0.0422, 0.0114, 0.0606, 0.0607, 0.0639, 0.0273, 0.0679, 0.1018, 0.0751, 0.0150, 0.0287, 0.0681, 0.0488, 0.0622, 0.0251, 0.0318, 0.0619)
cpREV <- c(0.0755, 0.0621, 0.0410, 0.0371, 0.0091, 0.0382, 0.0495, 0.0838, 0.0246, 0.0806, 0.1011, 0.0504, 0.0220, 0.0506, 0.0431, 0.0622, 0.0543, 0.0181, 0.0307, 0.0660)
HIVb <- c(0.060490222, 0.066039665, 0.044127815, 0.042109048, 0.020075899, 0.053606488, 0.071567447, 0.072308239, 0.022293943, 0.069730629, 0.098851122, 0.056968211, 0.019768318, 0.028809447, 0.046025282, 0.050604330, 0.053636813, 0.033011601, 0.028350243, 0.061625237)
HIVw <- c(0.0377494, 0.0573210, 0.0891129, 0.0342034, 0.0240105, 0.0437824, 0.0618606, 0.0838496, 0.0156076, 0.0983641, 0.0577867, 0.0641682, 0.0158419, 0.0422741, 0.0458601, 0.0550846, 0.0813774, 0.0195970, 0.0205847, 0.0515638)
FLU <- c(0.04707195, 0.05090995, 0.07421393, 0.04785995, 0.02502197, 0.03330397, 0.05458695, 0.07637292, 0.01996398, 0.06713393, 0.07149793, 0.05678494, 0.01815098, 0.03049597, 0.05065595, 0.08840891, 0.07433893, 0.01852398, 0.03147397, 0.06322894)

F2_1 <- c(0.0736301,0.0420659,0.0116857,0.00577884,0.0344768,0.0165771,0.0115874,0.0101828,0.0224098,0.125036,0.239506,0.00575243,0.0349387,0.0624289,0.0108474,0.0138127,0.0350863,0.0156735,0.0288336,0.19969)
F2_2 <- c(0.104035,0.0677371,0.0351037,0.0696185,0.0133054,0.0403634,0.0816521,0.0844854,0.0249323,0.0224157,0.066655,0.0620534,0.016237,0.0280571,0.0570639,0.0945127,0.049348,0.0118271,0.0245534,0.0460435)

F4_1 <- c(0.0920548,0.0553379,0.0318206,0.102457,0.00424498,0.0474943,0.119906,0.0734557,0.0188388,0.0201987,0.0561906,0.0754587,0.011812,0.0151568,0.0827026,0.0771459,0.0530929,0.00922952,0.011699,0.0417034)
F4_2 <- c(0.120477,0.0954101,0.0311517,0.0273694,0.0231719,0.0354826,0.040009,0.0944352,0.0354261,0.0220833,0.0866637,0.0494555,0.0241434,0.0485782,0.0272253,0.111013,0.0411052,0.0092355,0.031916,0.0456485)
F4_3 <- c(0.0646654,0.0218516,0.0176792,0.00771314,0.0325835,0.00968293,0.00998289,0.00825001,0.0119701,0.144137,0.235644,0.00401432,0.0299925,0.0462406,0.0127392,0.0107412,0.0323113,0.0295715,0.0429975,0.227232)
F4_4 <- c(1.75769e-05,0.147647,0.129944,0.01579,1.75769e-05,0.0316547,0.0698645,1.75769e-05,1.75769e-05,0.0914882,0.0368789,0.00748561,0.175769,1.75769e-05,0.065751,0.0360197,0.00290522,0.175769,1.75769e-05,0.0129274)

F8_1 <- c(0.0409033,0.0741969,0.0434624,0.101881,0.000138938,0.022723,0.0946703,0.130574,0.0198531,0.0447982,0.0211775,0.0765398,0.0102916,0.0292618,0.0553716,0.0936222,0.0203023,0.0121394,0.00590734,0.102186)
F8_2 <- c(0.122502,0.0864211,0.0131459,0.0296206,0.0420945,0.0236167,0.0318566,0.0716423,0.0518304,0.0200462,0.0745208,0.038587,0.0171778,0.0698471,0.00301989,0.137943,0.0345708,0.00893058,0.0661968,0.0564306)
F8_3 <- c(0.114751,0.0686446,0.0415785,0.0161699,0.00517152,0.0276677,0.0394709,0.0823982,0.0304912,0.0304595,0.0861152,0.0249556,0.0317259,0.0370365,0.138003,0.0916131,0.0297506,0.0266675,0.025516,0.051813)
F8_4 <- c(0.0384331,0.0523653,0.0296283,0.0589677,0.0209695,0.0590616,0.0948627,0.0793419,0.0284203,0.0270875,0.117713,0.0505763,7.85388e-05,0.00119073,0.0758,0.0850565,0.087913,0.0110557,0.0237146,0.0577635)
F8_5 <- c(0.190276,0.0977501,0.0313586,0.0436719,0.00390739,0.0634842,0.0779924,0.0622719,0.02192,0.0270238,0.104425,0.0936782,0.00473012,0.0166865,7.10101e-05,0.0820929,0.0262918,7.10101e-05,7.10101e-05,0.0522263)
F8_6 <- c(0.0848343,0.0622641,0.0329319,0.0860776,0.0186342,0.0407838,0.0452183,0.0599726,0.0250711,0.016412,0.107643,0.0652168,0.0539769,0.043927,0.0287562,0.0927383,0.0785924,0.0124281,6.04519e-05,0.044461)
F8_7 <- c(0.132455,0.0381045,0.0185515,0.106785,0.00130499,0.0387726,0.155934,0.0371834,0.00391036,0.0312659,0.0407655,0.0590639,0.0160001,0.0209356,0.0667009,0.040664,0.0565702,0.0191919,0.0628537,0.0529865)
F8_8 <- c(0.0626289,0.0256797,0.024621,0.00695919,0.0405735,0.00495012,0.00915175,0.0264558,0.00924011,0.153982,0.252472,0.000297637,0.0315357,0.0529799,0.0116112,0.00252614,0.0249839,0.0155478,0.0248986,0.218906)


# Add row names and column names to the matrix
profile_matrix <- rbind(F1_1,
                        # F2_1, F2_2,
                        #,F4_1, F4_2, F4_3, F4_4
                        #,F8_1, F8_2, F8_3, F8_4, F8_5, F8_6, F8_7, F8_8,
                        F10_1, F10_2, F10_3, F10_4, F10_5, F10_6, F10_7, F10_8, F10_9, F10_10,
                        #C10_1, C10_2, C10_3, C10_4, C10_5, C10_6, C10_7, C10_8, C10_9, C10_10,
                        Dayhoff, LG, JTT, WAG, VT, Blosum62, PMB
                        ,mtREV, mtMet, mtVer, mtInv, mtMAM, mtART, mtZOA, rtREV, cpREV, HIVb, HIVw, FLU
)
rownames(profile_matrix) <- c("F1.1 (1.0000)",
                              # "F2.1 (0.1916)", "F2.2 (0.8084)",
                              #,"F4.1 (0.4291)", "F4.2 (0.3900)", "F4.3 (0.1793)", "F4.4 (0.0015)"
                              #,"F8.1 (0.1227)", "F8.2 (0.1245)", "F8.3 (0.1257)", "F8.4 (0.1255)", "F8.5 (0.1251)", "F8.6 (0.1250)", "F8.7 (0.1265)", "F8.8 (0.1249)",
                              "F10.1 (0.1000)", "F10.2 (0.0994)", "F10.3 (0.0980)", "F10.4 (0.0987)", "F10.5 (0.1007)",
                              "F10.6 (0.0998)", "F10.7 (0.1009)", "F10.8 (0.1008)", "F10.9 (0.1016)", "F10.10 (0.1000)",
                              #"C10.1 (0.1191)", "C10.2 (0.0874)", "C10.3 (0.1037)", "C10.4 (0.0923)", "C10.5 (0.1070)","C10.6 (0.1330)", "C10.7 (0.0538)", "C10.8 (0.0692)", "C10.9 (0.1320)", "C10.10 (0.1024)",
                              "Dayhoff (1.0000)", "LG (1.0000)", "JTT (1.0000)", "WAG (1.0000)", "VT (1.0000)", "Blosum62 (1.0000)", "PMB (1.0000)"
                              ,"mtREV (1.0000)", "mtMet (1.0000)", "mtVer (1.0000)", "mtInv (1.0000)", "mtMAM (1.0000)", "mtART (1.0000)", "mtZOA (1.0000)", "rtREV (1.0000)", "cpREV (1.0000)", "HIVb (1.0000)", "HIVw (1.0000)", "FLU (1.0000)"
)

amino_acids <- c("A", "R", "N", "D", "C", "Q", "E", "G", "H", "I", "L", "K", "M", "F", "P", "S", "T", "W", "Y", "V")
colnames(profile_matrix) <- amino_acids

library(ggplot2)
library(ggrepel)

# Extract weights and scale them down to 50%
weights <- as.numeric(sub(".*\\((.*)\\)", "\\1", rownames(profile_matrix)))

# Extract labels, removing the brackets and the weights inside them
labels <- sub(" \\(.*\\)", "", rownames(profile_matrix))

# Create groups
groups <- sub("\\..*", "", labels)
general_indices <- which(labels %in% c("Dayhoff", "LG", "JTT", "WAG", "VT", "Blosum62", "PMB"))
groups[general_indices] <- "general"
mitochondrial_indices <- which(labels %in% c("mtREV", "mtMet", "mtVer", "mtInv", "mtMAM", "mtART", "mtZOA"))
groups[mitochondrial_indices] <- "mitochondrial"
viral_indices <- which(labels %in% c("rtREV", "cpREV", "HIVb", "HIVw", "FLU"))
groups[viral_indices] <- "viral"


# Perform PCA analysis
pca_result <- prcomp(profile_matrix, scale. = TRUE)

# Calculate the percentage of variance explained by each principal component
explained_variance <- pca_result$sdev^2 / sum(pca_result$sdev^2)
percent_variance <- explained_variance * 100

# Prepare the data frame for plotting
# Define factor levels for the desired group order
# Set the group order as F1, F10, general, mitochondrial, viral, C10
pca_data <- data.frame(pca_result$x, Weight = weights, Label = labels, Group = groups)

# Convert groups to factors with specific levels
groups <- factor(groups, levels = c("F1", "F10", "general", "mitochondrial", "viral"))##, "C10"))

# Define colors for each group
colors <- c("F1" = "#9e76aa", "F10" = "#F5A433", "general" = "#48ad64", "mitochondrial" = "#47c8df", "viral" = "#D097BA")#, "C10" = "#e22834")

# Plot PCA with custom color order
pca_data <- data.frame(pca_result$x, Weight = weights, Label = labels, Group = groups)

groups <- factor(groups, levels = c("F1", "F10", "general", "mitochondrial", "viral"))##, "C10"))

# Define the corresponding colors for each group
colors <- c("F1" = "#9e76aa", "F10" = "#F5A433", "general" = "#48ad64", "mitochondrial" = "#47c8df", "viral" = "#D097BA")#, "C10" = "#e22834")

# Plot the PCA with custom color order
ggplot(pca_data, aes(x = PC1, y = PC2, label = Label, color = Group)) +
  geom_point(aes(size = Weight), alpha = 0.7) +
  geom_text_repel() +
  scale_size_continuous(range = c(1, 5)) +
  scale_color_manual(values = colors) +
  theme_minimal() +
  labs(title = "PCA Plot of Frequency Vectors",
       x = paste0("PC1 (", round(percent_variance[1], 2), "%)"),
       y = paste0("PC2 (", round(percent_variance[2], 2), "%)"),
       size = "Weight",
       color = "Group") +
  theme(
    plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
    legend.title = element_text(size = 10),
    legend.text = element_text(size = 9),
    legend.key.size = unit(0.8, "lines"),
    legend.key.height = unit(0.6, "lines"),
    legend.key.width = unit(0.6, "lines"),
    legend.box.background = element_rect(color = "black", size = 0.5),
    legend.box.margin = margin(2, 2, 2, 2),
    legend.justification = "center",
    legend.box.just = "center",
    legend.title.align = 0.5
  )
